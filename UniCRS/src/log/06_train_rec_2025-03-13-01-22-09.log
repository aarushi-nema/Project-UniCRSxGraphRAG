2025-03-13 01:22:09.193 | INFO     | __main__:<module>:97 - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

2025-03-13 01:22:09.193 | INFO     | __main__:<module>:98 - {'seed': 42, 'output_dir': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/recommendation_prompt', 'debug': False, 'dataset': 'redial_gen', 'shot': 1, 'use_resp': False, 'context_max_length': 200, 'prompt_max_length': 200, 'entity_max_length': 32, 'num_workers': 0, 'tokenizer': 'microsoft/DialoGPT-small', 'text_tokenizer': None, 'model': 'microsoft/DialoGPT-small', 'text_encoder': None, 'num_bases': 8, 'n_prefix_rec': 10, 'prompt_encoder': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/pretrained_prompt/best', 'num_train_epochs': 5, 'max_train_steps': None, 'per_device_train_batch_size': 64, 'per_device_eval_batch_size': 64, 'gradient_accumulation_steps': 1, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'max_grad_norm': None, 'num_warmup_steps': 530, 'mixed_precision': 'no', 'use_wandb': False, 'entity': None, 'project': None, 'name': None, 'log_all': False}
2025-03-13 01:24:39.209 | INFO     | __main__:<module>:229 - ***** Running training *****
2025-03-13 01:24:39.209 | INFO     | __main__:<module>:230 -   Num examples = 182293
2025-03-13 01:24:39.209 | INFO     | __main__:<module>:231 -   Num Epochs = 5
2025-03-13 01:24:39.210 | INFO     | __main__:<module>:232 -   Instantaneous batch size per device = 64
2025-03-13 01:24:39.210 | INFO     | __main__:<module>:233 -   Total train batch size (w. parallel, distributed & accumulation) = 64
2025-03-13 01:24:39.210 | INFO     | __main__:<module>:234 -   Gradient Accumulation steps = 1
2025-03-13 01:24:39.210 | INFO     | __main__:<module>:235 -   Total optimization steps = 14245
2025-03-13 01:56:32.348 | INFO     | __main__:<module>:303 - epoch 0 train loss 5.9941016736470765
2025-03-13 01:58:37.439 | INFO     | __main__:<module>:339 - {'valid/recall@1': 0.090014064697609, 'valid/recall@10': 0.28712075547518584, 'valid/recall@50': 0.48673899939722726, 'valid/ndcg@1': 0.090014064697609, 'valid/ndcg@10': 0.17642283655204566, 'valid/ndcg@50': 0.22056950252411092, 'valid/mrr@1': 0.090014064697609, 'valid/mrr@10': 0.1425206094519163, 'valid/mrr@50': 0.15200486201370053, 'valid/loss': 5.837499181429545, 'epoch': 0}
2025-03-13 01:58:37.676 | INFO     | __main__:<module>:347 - new best model with loss
2025-03-13 02:01:14.063 | INFO     | __main__:<module>:381 - {'test/recall@1': 0.07347976327600587, 'test/recall@10': 0.2848631687651428, 'test/recall@50': 0.4856019382769988, 'test/ndcg@1': 0.07347976327600587, 'test/ndcg@10': 0.16477406369156372, 'test/ndcg@50': 0.20941709260932598, 'test/mrr@1': 0.07347976327600587, 'test/mrr@10': 0.12812996872765817, 'test/mrr@50': 0.13783186523786592, 'test/loss': 5.87427673243024, 'epoch': 0}
2025-03-13 02:24:15.695 | INFO     | __main__:<module>:303 - epoch 1 train loss 5.620776470019634
2025-03-13 02:26:20.510 | INFO     | __main__:<module>:339 - {'valid/recall@1': 0.0906168374522805, 'valid/recall@10': 0.2977697408077155, 'valid/recall@50': 0.5065802692384971, 'valid/ndcg@1': 0.0906168374522805, 'valid/ndcg@10': 0.18239512107255876, 'valid/ndcg@50': 0.22879837094384167, 'valid/mrr@1': 0.0906168374522805, 'valid/mrr@10': 0.14696521234004545, 'valid/mrr@50': 0.15703020024927164, 'valid/loss': 5.717247067353664, 'epoch': 1}
2025-03-13 02:26:20.819 | INFO     | __main__:<module>:347 - new best model with loss
2025-03-13 02:28:57.324 | INFO     | __main__:<module>:381 - {'test/recall@1': 0.07439329546808596, 'test/recall@10': 0.2885570163244231, 'test/recall@50': 0.5020057989434802, 'test/ndcg@1': 0.07439329546808596, 'test/ndcg@10': 0.1678518627182051, 'test/ndcg@50': 0.21553716096288278, 'test/mrr@1': 0.07439329546808596, 'test/mrr@10': 0.130922579853388, 'test/mrr@50': 0.14138270187696111, 'test/loss': 5.795272454392486, 'epoch': 1}
2025-03-13 02:51:58.974 | INFO     | __main__:<module>:303 - epoch 2 train loss 5.387262060835555
2025-03-13 02:54:03.173 | INFO     | __main__:<module>:339 - {'valid/recall@1': 0.08991360257183043, 'valid/recall@10': 0.30671087000200925, 'valid/recall@50': 0.5136628491058871, 'valid/ndcg@1': 0.08991360257183043, 'valid/ndcg@10': 0.18679095224752612, 'valid/ndcg@50': 0.232594274482934, 'valid/mrr@1': 0.08991360257183043, 'valid/mrr@10': 0.14986036598430907, 'valid/mrr@50': 0.1597131104840077, 'valid/loss': 5.676616124617747, 'epoch': 2}
2025-03-13 02:54:03.493 | INFO     | __main__:<module>:347 - new best model with loss
2025-03-13 02:56:39.146 | INFO     | __main__:<module>:381 - {'test/recall@1': 0.07514795249632601, 'test/recall@10': 0.2951503356237836, 'test/recall@50': 0.5069309290225206, 'test/ndcg@1': 0.07514795249632601, 'test/ndcg@10': 0.17112377569929896, 'test/ndcg@50': 0.21829967269233824, 'test/mrr@1': 0.07514795249632601, 'test/mrr@10': 0.13317105517933034, 'test/mrr@50': 0.14345927900775013, 'test/loss': 5.781864653989143, 'epoch': 2}
2025-03-13 03:19:40.363 | INFO     | __main__:<module>:303 - epoch 3 train loss 5.177260570586376
2025-03-13 03:21:44.301 | INFO     | __main__:<module>:339 - {'valid/recall@1': 0.09026522001205546, 'valid/recall@10': 0.31032750653003816, 'valid/recall@50': 0.5138637733574443, 'valid/ndcg@1': 0.09026522001205546, 'valid/ndcg@10': 0.1880199945138261, 'valid/ndcg@50': 0.23321934217713985, 'valid/mrr@1': 0.09026522001205546, 'valid/mrr@10': 0.15042231373693993, 'valid/mrr@50': 0.1602103195205759, 'valid/loss': 5.687134923079075, 'epoch': 3}
2025-03-13 03:24:20.153 | INFO     | __main__:<module>:381 - {'test/recall@1': 0.07431385788616594, 'test/recall@10': 0.29940024625650397, 'test/recall@50': 0.5090757437343607, 'test/ndcg@1': 0.07431385788616594, 'test/ndcg@10': 0.1728376958322576, 'test/ndcg@50': 0.21950611157380745, 'test/mrr@1': 0.07431385788616594, 'test/mrr@10': 0.1340635643394765, 'test/mrr@50': 0.14422971300691106, 'test/loss': 5.802070424036327, 'epoch': 3}
2025-03-13 03:47:22.873 | INFO     | __main__:<module>:303 - epoch 4 train loss 4.973278012682405
2025-03-13 03:49:26.738 | INFO     | __main__:<module>:339 - {'valid/recall@1': 0.08810528430781596, 'valid/recall@10': 0.3096242716495881, 'valid/recall@50': 0.5118545308418726, 'valid/ndcg@1': 0.08810528430781596, 'valid/ndcg@10': 0.18648746882142228, 'valid/ndcg@50': 0.23131497662685854, 'valid/mrr@1': 0.08810528430781596, 'valid/mrr@10': 0.14862530236745278, 'valid/mrr@50': 0.15829172837631228, 'valid/loss': 5.767244899884249, 'epoch': 4}
2025-03-13 03:52:02.601 | INFO     | __main__:<module>:381 - {'test/recall@1': 0.07387695118560592, 'test/recall@10': 0.29804980736386383, 'test/recall@50': 0.5026015808078802, 'test/ndcg@1': 0.07387695118560592, 'test/ndcg@10': 0.1716924836222048, 'test/ndcg@50': 0.2172677404910732, 'test/mrr@1': 0.07387695118560592, 'test/mrr@10': 0.1330194624402977, 'test/mrr@50': 0.14296335654503614, 'test/loss': 5.900062654224144, 'epoch': 4}
2025-03-13 03:52:02.830 | INFO     | __main__:<module>:388 - save final model
  


'valid/recall@1': 0.08991360257183043, 
'valid/recall@10': 0.30671087000200925, 
'valid/recall@50': 0.5136628491058871