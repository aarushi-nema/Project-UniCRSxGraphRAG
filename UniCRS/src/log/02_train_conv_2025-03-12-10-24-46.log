2025-03-12 10:24:46.103 | INFO     | __main__:<module>:90 - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

2025-03-12 10:24:46.104 | INFO     | __main__:<module>:91 - {'seed': 42, 'output_dir': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/conversation_prompt', 'debug': False, 'dataset': 'redial', 'num_workers': 0, 'context_max_length': 200, 'resp_max_length': 183, 'entity_max_length': 32, 'prompt_max_length': 200, 'tokenizer': 'microsoft/DialoGPT-small', 'ignore_pad_token_for_loss': True, 'text_tokenizer': None, 'model': 'microsoft/DialoGPT-small', 'max_gen_len': 50, 'text_encoder': None, 'prompt_encoder': '/home/Nema/UniCRS_GraphRAG/UniCRS/src/pretrained_prompt/best', 'n_prefix_conv': 20, 'num_bases': 8, 'num_train_epochs': 10, 'max_train_steps': None, 'per_device_train_batch_size': 8, 'per_device_eval_batch_size': 16, 'gradient_accumulation_steps': 1, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'max_grad_norm': None, 'num_warmup_steps': 6345, 'mixed_precision': 'no', 'use_wandb': False, 'entity': None, 'project': None, 'name': None, 'log_all': False}
2025-03-12 10:25:36.006 | INFO     | __main__:<module>:254 - ***** Running training *****
2025-03-12 10:25:36.006 | INFO     | __main__:<module>:255 -   Num examples = 50757
2025-03-12 10:25:36.006 | INFO     | __main__:<module>:256 -   Num Epochs = 10
2025-03-12 10:25:36.006 | INFO     | __main__:<module>:257 -   Instantaneous batch size per device = 8
2025-03-12 10:25:36.007 | INFO     | __main__:<module>:258 -   Total train batch size (w. parallel, distributed & accumulation) = 8
2025-03-12 10:25:36.007 | INFO     | __main__:<module>:259 -   Gradient Accumulation steps = 1
2025-03-12 10:25:36.007 | INFO     | __main__:<module>:260 -   Total optimization steps = 63450
2025-03-12 10:37:35.374 | INFO     | __main__:<module>:308 - epoch 0 train loss 2.901632683158766
2025-03-12 10:52:24.137 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15818724714820132, 'valid/bleu@2': 0.03442158519332868, 'valid/bleu@3': 0.016431334143092582, 'valid/bleu@4': 0.0082798753127066, 'valid/dist@1': 0.24349211970958032, 'valid/dist@2': 0.6539755622454401, 'valid/dist@3': 1.04692757216221, 'valid/dist@4': 1.3279617496015583, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.3696287130836726, 'epoch': 0}
2025-03-12 10:52:24.394 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 11:10:49.946 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15799019712717505, 'test/bleu@2': 0.03268367339090264, 'test/bleu@3': 0.014531630292141544, 'test/bleu@4': 0.007717529077912836, 'test/dist@1': 0.21010300550303374, 'test/dist@2': 0.5868491604345986, 'test/dist@3': 0.975306899957669, 'test/dist@4': 1.2792436856215605, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.392095190138634, 'epoch': 0}
2025-03-12 11:22:48.750 | INFO     | __main__:<module>:308 - epoch 1 train loss 2.2643469045254263
2025-03-12 11:36:46.419 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.1560875740716531, 'valid/bleu@2': 0.033435588551115586, 'valid/bleu@3': 0.017730907049294854, 'valid/bleu@4': 0.009660496952388084, 'valid/dist@1': 0.192668673632017, 'valid/dist@2': 0.5016823091907208, 'valid/dist@3': 0.7890915530370108, 'valid/dist@4': 0.9851248450504693, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.247251055733678, 'epoch': 1}
2025-03-12 11:36:46.764 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 11:53:01.698 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.16064866376146214, 'test/bleu@2': 0.03416291235325669, 'test/bleu@3': 0.017431142928984858, 'test/bleu@4': 0.011153788295324069, 'test/dist@1': 0.16777197685903766, 'test/dist@2': 0.4347396641738394, 'test/dist@3': 0.6978975589106815, 'test/dist@4': 0.8940313249611965, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.2905418975089527, 'epoch': 1}
2025-03-12 12:04:56.767 | INFO     | __main__:<module>:308 - epoch 2 train loss 2.1315306539512977
2025-03-12 12:20:39.139 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.158995818698009, 'valid/bleu@2': 0.037690259597874316, 'valid/bleu@3': 0.020613652331810388, 'valid/bleu@4': 0.011693585119978497, 'valid/dist@1': 0.3488578006020896, 'valid/dist@2': 0.9219054365149637, 'valid/dist@3': 1.484150876571631, 'valid/dist@4': 1.8978218523109616, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.1744352943836462, 'epoch': 2}
2025-03-12 12:20:39.478 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 12:40:42.248 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15796251583876683, 'test/bleu@2': 0.03586604791063408, 'test/bleu@3': 0.019426788043091486, 'test/bleu@4': 0.012538180435930161, 'test/dist@1': 0.30548892338083816, 'test/dist@2': 0.8323691265697757, 'test/dist@3': 1.383942429801044, 'test/dist@4': 1.8229151968392832, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.226128909711644, 'epoch': 2}
2025-03-12 12:52:38.092 | INFO     | __main__:<module>:308 - epoch 3 train loss 2.037062557838957
2025-03-12 13:04:21.200 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15384319447255676, 'valid/bleu@2': 0.03380435855522038, 'valid/bleu@3': 0.017083381860745903, 'valid/bleu@4': 0.009269377679323192, 'valid/dist@1': 0.2851071365326722, 'valid/dist@2': 0.7557995395785373, 'valid/dist@3': 1.1854081813352222, 'valid/dist@4': 1.50734903488578, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.1430612971357177, 'epoch': 3}
2025-03-12 13:04:21.534 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 13:18:24.253 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15475794397154222, 'test/bleu@2': 0.030670709143916272, 'test/bleu@3': 0.014419135588936177, 'test/bleu@4': 0.008486865022264225, 'test/dist@1': 0.242839000987724, 'test/dist@2': 0.6832228023140963, 'test/dist@3': 1.1068152956116835, 'test/dist@4': 1.4324820093128263, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.204658491885958, 'epoch': 3}
2025-03-12 13:30:20.837 | INFO     | __main__:<module>:308 - epoch 4 train loss 1.9649317607436243
2025-03-12 13:41:11.588 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.1531200687404502, 'valid/bleu@2': 0.03287791802581063, 'valid/bleu@3': 0.016439130224723722, 'valid/bleu@4': 0.008458550525756697, 'valid/dist@1': 0.29502390649902605, 'valid/dist@2': 0.7906853196387462, 'valid/dist@3': 1.2408358420400212, 'valid/dist@4': 1.5332034708694882, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.13555744754694, 'epoch': 4}
2025-03-12 13:41:11.956 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 13:54:43.481 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15263449655637268, 'test/bleu@2': 0.030755404299091404, 'test/bleu@3': 0.014245010499887719, 'test/bleu@4': 0.008303486533734536, 'test/dist@1': 0.260476929589389, 'test/dist@2': 0.7115845915055736, 'test/dist@3': 1.1347537745167207, 'test/dist@4': 1.4360095950331593, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.206844150885502, 'epoch': 4}
2025-03-12 14:06:41.185 | INFO     | __main__:<module>:308 - epoch 5 train loss 1.9027687665700348
2025-03-12 14:17:40.843 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15083843515008238, 'valid/bleu@2': 0.03682334247503506, 'valid/bleu@3': 0.01876310552815431, 'valid/bleu@4': 0.009304478128493493, 'valid/dist@1': 0.2794404108376129, 'valid/dist@2': 0.7681955020364796, 'valid/dist@3': 1.2326899238533735, 'valid/dist@4': 1.5303701080219585, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.1324926111583333, 'epoch': 5}
2025-03-12 14:17:41.180 | INFO     | __main__:<module>:364 - new best model with loss
2025-03-12 14:30:33.328 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.14891703878717583, 'test/bleu@2': 0.03137801524596731, 'test/bleu@3': 0.015150455360717373, 'test/bleu@4': 0.007649792785424805, 'test/dist@1': 0.23183293354028503, 'test/dist@2': 0.6582474954141385, 'test/dist@3': 1.0622266121066741, 'test/dist@4': 1.3664456046281925, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.2089023111097967, 'epoch': 5}
2025-03-12 14:42:27.536 | INFO     | __main__:<module>:308 - epoch 6 train loss 1.8456943737417812
2025-03-12 14:52:56.955 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15693606883947414, 'valid/bleu@2': 0.03799198991983727, 'valid/bleu@3': 0.018584040108927235, 'valid/bleu@4': 0.009808263863732094, 'valid/dist@1': 0.3228262794404108, 'valid/dist@2': 0.8578006020896051, 'valid/dist@3': 1.314680361253763, 'valid/dist@4': 1.610235523286701, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.1566342088385952, 'epoch': 6}
2025-03-12 15:05:29.602 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15873739250270733, 'test/bleu@2': 0.03558833294607691, 'test/bleu@3': 0.018211521070793758, 'test/bleu@4': 0.010347416637393149, 'test/dist@1': 0.2723296176097079, 'test/dist@2': 0.7573021024410893, 'test/dist@3': 1.1909129391844222, 'test/dist@4': 1.4937208974178073, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.237510177674735, 'epoch': 6}
2025-03-12 15:17:25.111 | INFO     | __main__:<module>:308 - epoch 7 train loss 1.7934471343238114
2025-03-12 15:28:29.076 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15595799867463617, 'valid/bleu@2': 0.0364717306417946, 'valid/bleu@3': 0.017981621207711376, 'valid/bleu@4': 0.008942759623946158, 'valid/dist@1': 0.34195147866123604, 'valid/dist@2': 0.9279263325659642, 'valid/dist@3': 1.4482025854435985, 'valid/dist@4': 1.7825394014520985, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.1723102868109856, 'epoch': 7}
2025-03-12 15:41:22.694 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15816155269423707, 'test/bleu@2': 0.035283732519939506, 'test/bleu@3': 0.016482290086111948, 'test/bleu@4': 0.008618942671338718, 'test/dist@1': 0.2802314096232538, 'test/dist@2': 0.806970509383378, 'test/dist@3': 1.2881332016367997, 'test/dist@4': 1.624523775927755, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.2617604186249642, 'epoch': 7}
2025-03-12 15:53:17.202 | INFO     | __main__:<module>:308 - epoch 8 train loss 1.7464086037719222
2025-03-12 16:04:33.490 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.15323684818337507, 'valid/bleu@2': 0.034731018301469574, 'valid/bleu@3': 0.01684142291455923, 'valid/bleu@4': 0.008784487033642844, 'valid/dist@1': 0.36514963697538516, 'valid/dist@2': 1.0023021073136178, 'valid/dist@3': 1.5599433327430494, 'valid/dist@4': 1.9302284398795821, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.193118868738666, 'epoch': 8}
2025-03-12 16:17:54.640 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.1534435355902499, 'test/bleu@2': 0.030868972400209967, 'test/bleu@3': 0.01421560648758377, 'test/bleu@4': 0.007004321641396409, 'test/dist@1': 0.2937773387893326, 'test/dist@2': 0.8263016791308029, 'test/dist@3': 1.3352617468604486, 'test/dist@4': 1.7091858332157472, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.2907471785965137, 'epoch': 8}
2025-03-12 16:29:50.443 | INFO     | __main__:<module>:308 - epoch 9 train loss 1.70797868937935
2025-03-12 16:41:23.732 | INFO     | __main__:<module>:356 - {'valid/bleu@1': 0.158050858013584, 'valid/bleu@2': 0.036244986915675494, 'valid/bleu@3': 0.018620782205387973, 'valid/bleu@4': 0.010346179962846454, 'valid/dist@1': 0.40038958739153535, 'valid/dist@2': 1.0851779706038605, 'valid/dist@3': 1.6892155126615902, 'valid/dist@4': 2.0796883300867717, 'valid/item_ratio': 0.0, 'valid/sent_cnt': 5647, 'valid/loss': 2.2184589371802788, 'epoch': 9}
2025-03-12 16:55:03.413 | INFO     | __main__:<module>:411 - {'test/bleu@1': 0.15981964058549608, 'test/bleu@2': 0.03459561181386395, 'test/bleu@3': 0.01658658307020396, 'test/bleu@4': 0.009188539634871602, 'test/dist@1': 0.3172005079723437, 'test/dist@2': 0.9002398758289827, 'test/dist@3': 1.4567517990687173, 'test/dist@4': 1.8643996049103992, 'test/item_ratio': 0.0, 'test/sent_cnt': 7087, 'test/loss': 2.318115630752615, 'epoch': 9}
2025-03-12 16:55:03.664 | INFO     | __main__:<module>:420 - save final model
